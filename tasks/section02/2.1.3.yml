---
# 2.1.3 Ensure discard services are not enabled (Scored)

- name: 2.1.3 Ensure discard services are not enabled (Scored)
  shell: chkconfig --list 2>/dev/null| grep discard
  register: chkcfg_svc
  changed_when: chkcfg_svc.stdout and chkcfg_svc.rc == 0
  failed_when: chkcfg_svc.rc not in (0, 1)
  ignore_errors: true
  tags:
    - level1
    - section02
    - section02_level1
    - scored
    - "2.1.3"

- name: 2.1.3 Ensure discard services are not enabled (Scored)
  service:
    name: "{{ item }}"
    state: stopped
    enable: false
  with_items:
    - discard-dgram
    - discard-stream
  when: chkcfg_svc.changed
  tags:
    - level1
    - section02
    - section02_level1
    - scored
    - "2.1.3"
